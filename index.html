<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mine Day Calculator</title>
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/air-datepicker@3.5.2/air-datepicker.css">
</head>
<body>
    <div class="container">
        <h1>Mine Day Calculator</h1>
        
        <div class="form-group">
            <label>Timezone:</label>
            <div class="dropdown-wrapper" id="timezone_wrapper">
                <input type="text" class="dropdown-input" id="timezone_input" placeholder="Search timezone..." autocomplete="off">
                <span class="dropdown-arrow">▼</span>
                <div class="dropdown-list" id="timezone_list">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="anchor_time">Anchor Time (local):</label>
            <div class="dropdown-wrapper" id="anchor_wrapper">
                <input type="text" class="dropdown-input" id="anchor_input" placeholder="Select anchor time..." autocomplete="off" readonly>
                <span class="dropdown-arrow">▼</span>
                <div class="dropdown-list" id="anchor_list">
                    <!-- Populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <div class="results" id="results">
            <div class="result-item">
                <div class="result-label">Current Mine Day and Time:</div>
                <div class="datetime-row">
                    <span class="mine-day-value" id="mineDay"></span>
                    <span class="time-display" id="mineDayTime">00:00:00</span>
                </div>
            </div>
            
            <div class="result-item">
                <div class="result-label">Actual Time in Timezone: (<span id="selectedTz"></span>)<span class="utc-offset" id="utcOffset"></span></div>
                <div class="datetime-row">
                    <span class="actual-day-value" id="actualDay"></span>
                    <span class="time-display actual-time-display" id="actualTime">00:00:00</span>
                    <button type="button" class="btn-link" id="editSimTimeBtn" aria-label="Edit simulated time"><svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zm2.92 2.83H5v-.92l8.06-8.06.92.92L5.92 20.08zM20.71 7.04a1.003 1.003 0 0 0 0-1.42l-2.34-2.34a1.003 1.003 0 0 0-1.42 0l-1.83 1.83 3.75 3.75 1.84-1.82z"/></svg></button>
                    <button type="button" class="btn-link btn-reset" id="resetSimTimeBtn" aria-label="Reset simulated time" style="display:none;">Reset</button>
                </div>

                <div class="sim-editor" id="simEditor" style="display:none;">
                    <div class="sim-editor-row">
                        <input type="text" class="sim-input" id="simDateTimePicker" placeholder="Select date & time">
                        <button type="button" class="btn-primary" id="simOkBtn">OK</button>
                        <button type="button" class="btn-link" id="simCancelBtn">Cancel</button>
                    </div>
                </div>
            </div>
            
            <div class="result-item">
                <div class="result-label">Current Mine Day's Range (<span id="rangeTz"></span>):</div>
                <div class="result-value range-iso" id="mineDayRange"></div>
            </div>
            
            <div class="result-item">
                <div class="result-label">Current Mine Day's Range (UTC):</div>
                <div class="result-value range-iso" id="mineDayRangeUtc"></div>
            </div>
        </div>

        <details class="rules-info">
            <summary>How Mine Day is Calculated</summary>
            <ol>
                <li><strong>Anchor = 00:00:</strong> Mine day = calendar day (ISO standard)</li>
                <li><strong>Anchor &lt; 12:00:</strong> Mine day starts at anchor, ends next day at anchor</li>
                <li><strong>Anchor ≥ 12:00:</strong> Mine day starts previous day at anchor, ends at anchor</li>
            </ol>
        </details>
    </div>

    <div class="timeline-section" id="timelineSection" style="display: none;">
        <div class="timeline-container">
            <div class="timeline-title">Mine Day Timeline (ISO Hours)</div>
            <canvas class="timeline-canvas" id="timelineCanvas"></canvas>
            <div class="timeline-legend">
                <div class="legend-item">
                    <div class="legend-color legend-mineday"></div>
                    <span>Mine Day Range</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-current"></div>
                    <span>Current Time</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color legend-isoday"></div>
                    <span>ISO Calendar Day</span>
                </div>
            </div>
        </div>
    </div>
    <!-- Air Datepicker -->
    <script src="https://cdn.jsdelivr.net/npm/air-datepicker@3.5.2/air-datepicker.js"></script>
    <script src="index.js"></script>
</body>
</html>